# This is a sample build configuration for Other.
# Check our guides at https://confluence.atlassian.com/x/5Q4SMw for more examples.
# Only use spaces to indent your .yml configuration.
# -----
# You can specify a custom docker image from Docker Hub as your build environment.

image: php:7.2-fpm

pipelines:
  branches:
    pipeline-new-local-dev:
    - step:
        
        name: Deploy to develop 
        script:
          - apt-get update && apt-get install -y openssh-client
          - mkdir -p ~/.ssh
          - cat .develop_hosts >> ~/.ssh/known_hosts
          - (umask  077 ; echo $devkey2 | base64 --decode > ~/.ssh/id_rsa)

          - ssh multi-frontend@ninepinetechnology-tmcrjvwbpr.dynamic-m.com -p 9913 '. compile.sh'


definitions:
      services:
        postgres:
            image: postgres
            environment:
                POSTGRES_USER: 'postgres'
                POSTGRES_PASSWORD: 'testuser'
                POSTGRES_DB: 'test'
